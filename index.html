<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#16213e" />
  <meta name="google-adsense-account" content="ca-pub-1816282885500573">
  <title>JupterNews - Not√≠cias Atuais e Confi√°veis</title>

  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="logo.svg" type="image/svg+xml" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />

  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1816282885500573" crossorigin="anonymous"></script>
</head>
<body>
  <header>
    <div class="header-container">
      <div class="logo-area">
        <div class="logo-inline" aria-hidden="true">
          <svg id="jupter-logo" width="56" height="56" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="JupterNews logo">
            <circle cx="32" cy="32" r="28" fill="#00b4d8"/>
            <path d="M8 34c15 10 34 10 48 0" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round"/>
            <circle cx="44" cy="20" r="6" fill="#90e0ef"/>
          </svg>
        </div>
        <div class="brand-text">
          <h1><span class="brand">JupterNews</span></h1>
          <p class="tagline">Not√≠cias do mundo em tempo real</p>
        </div>
      </div>

      <div class="user-actions">
        <button class="subscribe-btn" id="subscribeBtn"><i class="fas fa-bell"></i> Assinar Not√≠cias</button>
        <a id="whatsappChannel" href="https://whatsapp.com/channel/0029Vb7IQJFAu3aLGetT6r00" class="whatsapp-btn" target="_blank" rel="noopener">
          <i class="fab fa-whatsapp"></i> Canal WhatsApp
        </a>
        <button class="menu-toggle" id="menuToggle">
          <i class="fas fa-bars"></i>
        </button>
      </div>
    </div>

    <nav class="main-nav">
      <ul class="nav-list" id="navList">
        <li><a href="#" class="nav-link active" data-category="all"><i class="fas fa-home"></i> In√≠cio</a></li>
        <li><a href="#" class="nav-link" data-category="urgentes"><i class="fas fa-bolt"></i> Urgentes</a></li>
        <li><a href="#" class="nav-link" data-category="economia"><i class="fas fa-chart-line"></i> Economia</a></li>
        <li><a href="#" class="nav-link" data-category="ciencia"><i class="fas fa-flask"></i> Ci√™ncia</a></li>
        <li><a href="#" class="nav-link" data-category="esportes"><i class="fas fa-futbol"></i> Esportes</a></li>
        <li><a href="#" class="nav-link" data-category="cultura"><i class="fas fa-music"></i> Cultura</a></li>
        <li><a href="#" class="nav-link" data-category="tecnologia"><i class="fas fa-laptop-code"></i> Tecnologia</a></li>
        <li><a href="#" class="nav-link" data-category="saude"><i class="fas fa-heartbeat"></i> Sa√∫de</a></li>
        <li class="search-item">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Buscar not√≠cias...">
            <button id="searchBtn">Buscar</button>
          </div>
        </li>
      </ul>
    </nav>

    <div class="breaking-news">
      <span class="breaking-label"><i class="fas fa-bolt"></i> URGENTE:</span>
      <marquee>Intelig√™ncia Artificial revoluciona setor de sa√∫de ‚Ä¢ Pre√ßos dos alimentos caem pelo 3¬∫ m√™s consecutivo</marquee>
    </div>
  </header>

  <main class="container">
    <div class="content-wrapper">
      <section class="featured-news">
        <h2 class="section-title"><i class="fas fa-star"></i> <span id="sectionTitle">Destaques do Dia</span></h2>
        <div class="featured-grid" id="featuredContainer"></div>
      </section>

      <div class="adsense-middle">
        <ins class="adsbygoogle"
             style="display:block; text-align:center;"
             data-ad-layout="in-article"
             data-ad-format="fluid"
             data-ad-client="ca-pub-1816282885500573"
             data-ad-slot="9876543210"></ins>
      </div>

      <div class="main-content">
        <section class="news-list">
          <h2 class="section-title"><i class="fas fa-newspaper"></i> <span id="newsListTitle">√öltimas Not√≠cias</span></h2>
          <div id="newsContainer" class="news-grid"></div>
          <div class="load-more">
            <button id="loadMoreBtn"><i class="fas fa-plus"></i> Carregar Mais Not√≠cias</button>
          </div>
        </section>

        <aside class="sidebar">
          <div class="sidebar-section">
            <h3><i class="fas fa-play-circle"></i> V√≠deos em Destaque</h3>
            <div class="video-item" onclick="playVideo('Lan√ßamento do Novo Foguete Espacial')">
              <div class="video-thumbnail">
                <img src="https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?auto=format&fit=crop&w=400&q=80" alt="Foguete Espacial">
                <div class="play-button"><i class="fas fa-play"></i></div>
              </div>
              <h4>Lan√ßamento do Novo Foguete Espacial</h4>
              <span class="video-duration">3:45</span>
            </div>
            <div class="video-item" onclick="playVideo('Entrevista com Cientista da NASA')">
              <div class="video-thumbnail">
                <img src="https://images.unsplash.com/photo-1532094349884-543bc11b234d?auto=format&fit=crop&w=400&q=80" alt="Entrevista NASA">
                <div class="play-button"><i class="fas fa-play"></i></div>
              </div>
              <h4>Entrevista Exclusiva com Cientista da NASA</h4>
              <span class="video-duration">5:20</span>
            </div>
          </div>

          <div class="sidebar-section whatsapp-channel">
            <h3><i class="fab fa-whatsapp"></i> Nosso Canal</h3>
            <div class="whatsapp-info">
              <div class="whatsapp-icon"><i class="fab fa-whatsapp"></i></div>
              <p>Receba as not√≠cias urgentes diretamente no nosso canal do WhatsApp!</p>
              <a id="whatsappJoin" href="https://whatsapp.com/channel/0029Vb7IQJFAu3aLGetT6r00" class="whatsapp-join" target="_blank" rel="noopener">
                <i class="fab fa-whatsapp"></i> Entrar no Canal
              </a>
              <div class="whatsapp-stickers">
                <span class="sticker">üöÄ</span>
                <span class="sticker">üì∞</span>
                <span class="sticker">‚≠ê</span>
                <span class="sticker">üîî</span>
                <span class="sticker">üåç</span>
              </div>
            </div>
          </div>

          <div class="sidebar-section adsense-sidebar">
            <h3><i class="fas fa-ad"></i> Patrocinado</h3>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-format="rectangle"
                 data-ad-client="ca-pub-1816282885500573"
                 data-ad-slot="5678901234"></ins>
          </div>

          <div class="sidebar-section">
            <h3><i class="fas fa-chart-line"></i> Mais Lidas Hoje</h3>
            <ol class="top-news" id="topNewsList"></ol>
          </div>
        </aside>
      </div>
    </div>
  </main>

  <div id="newsModal" class="modal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <div id="modalNewsContent"></div>

      <div class="comments-section">
        <h3><i class="far fa-comments"></i> Coment√°rios <span id="commentCount">(0)</span></h3>
        <div class="comment-form">
          <textarea id="commentText" placeholder="Deixe seu coment√°rio (n√£o precisa de conta)..." rows="3" maxlength="500"></textarea>
          <div class="comment-actions">
            <button id="submitCommentBtn" class="submit-comment"><i class="fas fa-paper-plane"></i> Enviar Coment√°rio</button>
            <div class="comment-info">
              <i class="fas fa-info-circle"></i> <span id="charCount">0/500</span> caracteres
            </div>
          </div>
        </div>
        <div id="commentsList" class="comments-list"></div>
      </div>
    </div>
  </div>

  <div id="videoModal" class="modal video-modal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <div id="videoPlayer"></div>
    </div>
  </div>

  <div id="subscribeModal" class="modal subscribe-modal">
    <div class="modal-content">
      <span class="close-modal">&times;</span>
      <div class="subscribe-content">
        <h2><i class="fas fa-envelope"></i> Newsletter Di√°ria</h2>
        <p>Receba as principais not√≠cias diretamente no seu e-mail ‚Äî gratuito.</p>

        <div class="subscribe-form">
          <h3>Informe seu e-mail</h3>
          <div class="form-group">
            <input type="email" id="subscribeEmail" placeholder="seu@email.com">
            <button id="confirmSubscribeBtn">Confirmar Assinatura</button>
          </div>
          <p class="privacy-note">Ao assinar, voc√™ concorda com nossa <a href="#">Pol√≠tica de Privacidade</a>.</p>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3><i class="fas fa-planet-ringed"></i> JupterNews</h3>
        <p>Levando as not√≠cias mais importantes do planeta diretamente para voc√™. Atualiza√ß√µes 24/7.</p>
        <div class="whatsapp-footer">
          <a id="whatsappFooter" href="https://whatsapp.com/channel/0029Vb7IQJFAu3aLGetT6r00" class="whatsapp-link" target="_blank" rel="noopener">
            <i class="fab fa-whatsapp"></i> Receba no WhatsApp
          </a>
        </div>
      </div>

      <div class="footer-section">
        <h4>Editorias</h4>
        <ul>
          <li><a href="#" onclick="filterNews('urgentes')">Urgentes</a></li>
          <li><a href="#" onclick="filterNews('economia')">Economia</a></li>
          <li><a href="#" onclick="filterNews('ciencia')">Ci√™ncia</a></li>
          <li><a href="#" onclick="filterNews('esportes')">Esportes</a></li>
          <li><a href="#" onclick="filterNews('tecnologia')">Tecnologia</a></li>
          <li><a href="#" onclick="filterNews('saude')">Sa√∫de</a></li>
          <li><a href="#" onclick="filterNews('cultura')">Cultura</a></li>
        </ul>
      </div>

      <div class="footer-section">
        <h4>Recursos</h4>
        <ul>
          <li><a href="#" onclick="showAbout()">Sobre a JupterNews</a></li>
          <li><a href="#" onclick="showContact()">Contato</a></li>
          <li><a href="#" onclick="showPrivacy()">Privacidade</a></li>
          <li><a href="#" onclick="showTerms()">Termos de Uso</a></li>
          <li><a href="#" onclick="showCareers()">Trabalhe Conosco</a></li>
        </ul>
      </div>

      <div class="footer-section">
        <h4>Assine nosso Boletim</h4>
        <div class="newsletter">
          <input type="email" id="newsletterEmail" placeholder="Seu melhor e-mail">
          <button type="button" id="footerSubscribeBtn"><i class="fas fa-paper-plane"></i></button>
        </div>
        <p>Receba os destaques di√°rios no seu e-mail.</p>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2023 JupterNews. Todas as not√≠cias s√£o verificadas por nossa equipe editorial.</p>
      <p class="adsense-code">google.com, pub-1816282885500573, DIRECT, f08c47fec0942fa0</p>
    </div>
  </footer>

  <!-- Incluir TODOS os scripts dentro do HTML para evitar problemas de carregamento -->
  <script>
    // news-data.js - Embed direto no HTML
    window.newsData = [
      {
        id: 1,
        title: "TERREMOTO DE 7.2 ATINGE COSTA DO CHILE - ALERTA DE TSUNAMI EMITIDO",
        excerpt: "Tremor de magnitude 7.2 foi registrado no norte do Chile. Autoridades emitem alerta de tsunami.",
        fullContent: `<p>Um forte terremoto de magnitude 7.2 atingiu a regi√£o norte do Chile, causando p√¢nico entre a popula√ß√£o local.</p>`,
        image: "https://images.unsplash.com/photo-1506252374453-ef5237294c74?auto=format&fit=crop&w=1000&q=80",
        category: "urgentes",
        categoryName: "URGENTE",
        time: "15 minutos atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 2,
        title: "SUSPEITA DE VAR√çOLA DOS MACACOS EM S√ÉO PAULO - MINIST√âRIO DA SA√öDE INVESTIGA",
        excerpt: "Paciente com sintomas compat√≠veis com monkeypox est√° isolado no Hospital das Cl√≠nicas.",
        fullContent: `<p>O Minist√©rio da Sa√∫de confirmou que est√° investigando um caso suspeito de var√≠ola dos macacos.</p>`,
        image: "https://images.unsplash.com/photo-1559757148-5c350d0d3c56?auto=format&fit=crop&w=1000&q=80",
        category: "urgentes",
        categoryName: "URGENTE",
        time: "1 hora atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 3,
        title: "APAG√ÉO AFETA 5 ESTADOS DO NORDESTE - ENERGIA AINDA N√ÉO FOI TOTALMENTE RESTABELECIDA",
        excerpt: "Falta de energia atinge milh√µes de consumidores. Equipes trabalham para restaurar o fornecimento.",
        fullContent: `<p>Um apag√£o de grandes propor√ß√µes atingiu cinco estados do Nordeste brasileiro.</p>`,
        image: "https://images.unsplash.com/photo-1558618666-fcd25c85cd64?auto=format&fit=crop&w=1000&q=80",
        category: "urgentes",
        categoryName: "URGENTE",
        time: "3 horas atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 4,
        title: "D√ìLAR CAI PARA R$ 4,85 - MENOR VALOR EM 8 MESES",
        excerpt: "Moeda americana recua 2,3% ap√≥s an√∫ncio do Fed sobre poss√≠vel redu√ß√£o nos juros.",
        fullContent: `<p>O d√≥lar comercial fechou esta ter√ßa-feira cotado a R$ 4,85, a menor taxa em oito meses.</p>`,
        image: "https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?auto=format&fit=crop&w=1000&q=80",
        category: "economia",
        categoryName: "Economia",
        time: "5 horas atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 5,
        title: "DESEMPREGO CAI PARA 8,3% - MENOR TAXA DESDE 2015",
        excerpt: "Pesquisa do IBGE mostra cria√ß√£o de 1,2 milh√£o de vagas formais no trimestre.",
        fullContent: `<p>A taxa de desemprego no Brasil caiu para 8,3% no trimestre encerrado em outubro.</p>`,
        image: "https://images.unsplash.com/photo-1586769852044-692eb51d3d6e?auto=format&fit=crop&w=1000&q=80",
        category: "economia",
        categoryName: "Economia",
        time: "1 dia atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 6,
        title: "NASA CONFIRMA PRESEN√áA DE √ÅGUA EM EUROPA, LUA DE J√öPITER",
        excerpt: "Miss√£o Europa Clipper detecta plumas de √°gua saindo da superf√≠cie gelada.",
        fullContent: `<p>A NASA anunciou hoje a confirma√ß√£o da presen√ßa de √°gua em Europa, uma das luas de J√∫piter.</p>`,
        image: "https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?auto=format&fit=crop&w=1000&q=80",
        category: "ciencia",
        categoryName: "Ci√™ncia",
        time: "2 horas atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 7,
        title: "ATLETA BRASILEIRA QUEBRA RECORDE MUNDIAL NOS 400m RASOS",
        excerpt: "Mariana Silva marca 47.85 segundos no Meeting de Paris, superando recorde que durava 17 anos.",
        fullContent: `<p>Em uma performance hist√≥rica, a atleta brasileira Mariana Silva quebrou o recorde mundial dos 400 metros.</p>`,
        image: "https://images.unsplash.com/photo-1552674605-db6ffd8facb5?auto=format&fit=crop&w=1000&q=80",
        category: "esportes",
        categoryName: "Esportes",
        time: "3 horas atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 8,
        title: "FILME NACIONAL BATE RECORDE DE BILHETERIA EM ESTREIA MUNDIAL",
        excerpt: "Produ√ß√£o brasileira 'Cidade Invis√≠vel' arrecada R$ 52 milh√µes no primeiro final de semana.",
        fullContent: `<p>O filme nacional 'Cidade Invis√≠vel' bateu recorde de bilheteria em sua estreia mundial.</p>`,
        image: "https://images.unsplash.com/photo-1489599809516-9827b6d1cf13?auto=format&fit=crop&w=1000&q=80",
        category: "cultura",
        categoryName: "Cultura",
        time: "2 dias atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 9,
        title: "APLICATIVO REVOLUCIONA APRENDIZADO DE IDIOMAS COM REALIDADE AUMENTADA",
        excerpt: "Startup cria sistema que permite conversa√ß√£o imersiva em qualquer l√≠ngua usando √≥culos de realidade aumentada.",
        fullContent: `<p>Uma startup brasileira lan√ßou o LinguaAR, um aplicativo que promete revolucionar o aprendizado de idiomas.</p>`,
        image: "https://images.unsplash.com/photo-1551650975-87deedd944c3?auto=format&fit=crop&w=1000&q=80",
        category: "tecnologia",
        categoryName: "Tecnologia",
        time: "1 dia atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 10,
        title: "NOVO TRATAMENTO PARA ALZHEIMER MOSTRA 85% DE EFIC√ÅCIA EM ESTUDO",
        excerpt: "Medicamento desenvolvido por startup brasileira reduz progress√£o da doen√ßa em testes cl√≠nicos de fase 3.",
        fullContent: `<p>Um novo tratamento apresentou 85% de efic√°cia em retardar a progress√£o do Alzheimer.</p>`,
        image: "https://images.unsplash.com/photo-1559757148-5c350d0d3c56?auto=format&fit=crop&w=1000&q=80",
        category: "saude",
        categoryName: "Sa√∫de",
        time: "8 horas atr√°s",
        views: 0,
        comments: 0
      },
      {
        id: 11,
        title: "UCR√ÇNIA INTENSIFICA ATAQUES A INFRAESTRUTURA ENERG√âTICA RUSSA",
        excerpt: "Drones ucranianos atingem plataforma petrol√≠fera no Mar C√°spio em nova fase da campanha.",
        fullContent: `<p>A Ucr√¢nia anunciou que atingiu uma plataforma petrol√≠fera no Mar C√°spio.</p>`,
        image: "https://images.unsplash.com/photo-1560969184-10fe8719e047?auto=format&fit=crop&w=1000&q=80",
        category: "urgentes",
        categoryName: "URGENTE",
        time: "4 horas atr√°s",
        views: 0,
        comments: 0
      }
    ];
  </script>

  <script>
    // script.js - Embed direto no HTML
    // ==============================================
    // JupterNews - Script Principal
    // ==============================================
    
    const STORAGE_COMMENTS_KEY = 'jupterNewsComments';
    const STORAGE_USER_KEY = 'jupterNewsUser';
    const STORAGE_LIKED_KEY = 'jupterNewsLiked';
    const STORAGE_SUBSCRIBERS_KEY = 'jupterNewsSubscribers';
    const FORM_ENDPOINT = 'https://formspree.io/f/mkgdpbzw';

    const appState = {
      currentCategory: 'all',
      currentNews: [],
      displayedNews: 6,
      currentNewsId: null,
      userComments: JSON.parse(localStorage.getItem(STORAGE_COMMENTS_KEY)) || {},
      likedByUser: JSON.parse(localStorage.getItem(STORAGE_LIKED_KEY)) || [],
      userName: localStorage.getItem(STORAGE_USER_KEY) || null,
      subscribers: JSON.parse(localStorage.getItem(STORAGE_SUBSCRIBERS_KEY)) || []
    };

    // Garantir nome de usu√°rio persistente
    if (!appState.userName) {
      const rand = Math.floor(1000 + Math.random() * 9000);
      appState.userName = `Usu√°rio ${rand}`;
      localStorage.setItem(STORAGE_USER_KEY, appState.userName);
    }

    // Inicializar quando o DOM estiver carregado
    document.addEventListener('DOMContentLoaded', () => {
      console.log('JupterNews carregando...');
      
      // Elementos DOM
      const navListEl = document.getElementById('navList');
      const loadMoreBtn = document.getElementById('loadMoreBtn');
      const newsContainer = document.getElementById('newsContainer');
      const featuredContainer = document.getElementById('featuredContainer');
      const menuToggle = document.getElementById('menuToggle');
      const searchInput = document.getElementById('searchInput');
      const searchBtn = document.getElementById('searchBtn');
      const subscribeBtn = document.getElementById('subscribeBtn');
      const commentText = document.getElementById('commentText');
      const submitCommentBtn = document.getElementById('submitCommentBtn');
      const confirmSubscribeBtn = document.getElementById('confirmSubscribeBtn');
      const footerSubscribeBtn = document.getElementById('footerSubscribeBtn');

      // Inicializar app
      initializeApp();

      // Toggle menu mobile
      if (menuToggle) {
        menuToggle.addEventListener('click', () => {
          navListEl.classList.toggle('active');
        });
      }

      // Navega√ß√£o por categoria
      if (navListEl) {
        navListEl.addEventListener('click', (e) => {
          const link = e.target.closest('.nav-link');
          if (!link) return;
          e.preventDefault();
          const category = link.getAttribute('data-category');
          
          // Ativar link clicado
          document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
          link.classList.add('active');
          
          // Filtrar not√≠cias
          filterByCategory(category);
          
          // Fechar menu mobile se aberto
          navListEl.classList.remove('active');
        });
      }

      // Event Listeners
      if (loadMoreBtn) loadMoreBtn.addEventListener('click', loadMoreNews);
      if (subscribeBtn) subscribeBtn.addEventListener('click', () => openModal('subscribeModal'));
      if (searchBtn) searchBtn.addEventListener('click', searchNews);
      if (searchInput) searchInput.addEventListener('keypress', (e) => { 
        if (e.key === 'Enter') searchNews(); 
      });

      // Contador de caracteres no coment√°rio
      if (commentText) {
        commentText.addEventListener('input', function () {
          const charCount = document.getElementById('charCount');
          if (charCount) charCount.textContent = `${this.value.length}/500`;
        });
      }

      // Fechar modais
      document.querySelectorAll('.close-modal').forEach(btn => {
        btn.addEventListener('click', closeAllModals);
      });

      // Fechar modal ao clicar fora
      window.addEventListener('click', (event) => {
        if (event.target.classList.contains('modal')) {
          closeAllModals();
        }
      });

      // Fechar modal com ESC
      document.addEventListener('keydown', (e) => { 
        if (e.key === 'Escape') closeAllModals(); 
      });

      // Bot√µes de a√ß√£o
      if (submitCommentBtn) submitCommentBtn.addEventListener('click', submitCommentHandler);
      if (confirmSubscribeBtn) confirmSubscribeBtn.addEventListener('click', subscribeModalHandler);
      if (footerSubscribeBtn) footerSubscribeBtn.addEventListener('click', footerSubscribeHandler);

      // Curtidas em coment√°rios (delega√ß√£o)
      document.body.addEventListener('click', (e) => {
        const likeBtn = e.target.closest('.like-btn');
        if (likeBtn) {
          const newsId = parseInt(likeBtn.dataset.newsId, 10);
          const commentId = parseInt(likeBtn.dataset.commentId, 10);
          toggleLike(newsId, commentId);
        }
      });

      // ==============================================
      // FUN√á√ïES PRINCIPAIS
      // ==============================================

      function initializeApp() {
        // Carregar dados das not√≠cias
        if (window.newsData && Array.isArray(window.newsData)) {
          appState.currentNews = [...window.newsData];
          console.log(`${window.newsData.length} not√≠cias carregadas`);
        } else {
          console.error('Dados das not√≠cias n√£o encontrados');
          appState.currentNews = [];
        }
        
        // Carregar conte√∫do inicial
        loadFeaturedNews();
        loadInitialNews();
        loadTopNews();
        
        // Inicializar AdSense
        if (window.adsbygoogle) {
          (adsbygoogle = window.adsbygoogle || []).push({});
        }
        
        console.log('JupterNews inicializado com sucesso!');
      }

      function loadFeaturedNews() {
        if (!featuredContainer) return;
        
        const featured = getCurrentNews().slice(0, 3);
        featuredContainer.innerHTML = '';
        
        if (featured.length === 0) {
          featuredContainer.innerHTML = '<p class="no-news">Nenhuma not√≠cia em destaque</p>';
          return;
        }
        
        featured.forEach((news, index) => {
          const article = document.createElement('article');
          article.className = index === 0 ? 'main-featured' : 'secondary-featured';
          article.setAttribute('data-id', news.id);
          
          const commentsCount = getCommentsCount(news.id);
          const isMain = index === 0;
          
          article.innerHTML = `
            <div class="news-image">
              <img src="${news.image}" alt="${escapeHtml(news.title)}" loading="lazy">
              <span class="category-label ${news.category}">${news.categoryName}</span>
              ${isMain ? '<div class="featured-badge"><i class="fas fa-crown"></i> EM DESTAQUE</div>' : ''}
            </div>
            <div class="news-content">
              <h3 class="news-title">${escapeHtml(news.title)}</h3>
              ${isMain ? `<p class="news-excerpt">${news.excerpt}</p>` : ''}
              <div class="news-meta">
                <span><i class="far fa-clock"></i> ${news.time}</span>
                <span><i class="far fa-comment"></i> ${commentsCount} coment√°rios</span>
              </div>
            </div>
          `;
          
          // Adicionar evento de clique
          article.addEventListener('click', () => openNewsModal(news.id));
          featuredContainer.appendChild(article);
        });
      }

      function loadInitialNews() {
        if (!newsContainer) return;
        
        newsContainer.innerHTML = '';
        appState.displayedNews = 6;
        const newsToShow = getCurrentNews().slice(0, appState.displayedNews);
        
        if (newsToShow.length === 0) {
          newsContainer.innerHTML = '<div class="no-news"><p>Nenhuma not√≠cia encontrada</p></div>';
          updateLoadMoreButton();
          return;
        }
        
        newsToShow.forEach(news => {
          newsContainer.appendChild(createNewsCard(news));
        });
        
        updateLoadMoreButton();
      }

      function createNewsCard(news) {
        const card = document.createElement('article');
        card.className = 'news-card';
        card.setAttribute('data-id', news.id);
        
        const commentsCount = getCommentsCount(news.id);
        
        card.innerHTML = `
          <div class="news-image">
            <img src="${news.image}" alt="${escapeHtml(news.title)}" loading="lazy">
            <span class="category-label ${news.category}">${news.categoryName}</span>
          </div>
          <div class="news-content">
            <h3 class="news-title">${escapeHtml(news.title)}</h3>
            <p class="news-excerpt">${news.excerpt}</p>
            <div class="news-meta">
              <span><i class="far fa-clock"></i> ${news.time}</span>
              <span><i class="far fa-comment"></i> ${commentsCount} coment√°rios</span>
            </div>
          </div>
        `;
        
        card.addEventListener('click', () => openNewsModal(news.id));
        return card;
      }

      function loadMoreNews() {
        if (!newsContainer) return;
        
        const currentNews = getCurrentNews();
        const start = appState.displayedNews;
        const end = start + 3;
        const moreNews = currentNews.slice(start, end);
        
        if (moreNews.length === 0) {
          showNotification('Todas as not√≠cias foram carregadas!');
          return;
        }
        
        moreNews.forEach(news => {
          newsContainer.appendChild(createNewsCard(news));
        });
        
        appState.displayedNews = Math.min(end, currentNews.length);
        updateLoadMoreButton();
      }

      function filterByCategory(category) {
        appState.currentCategory = category;
        
        // Atualizar t√≠tulos
        const sectionTitle = document.getElementById('sectionTitle');
        const newsListTitle = document.getElementById('newsListTitle');
        
        if (category === 'all') {
          sectionTitle.textContent = 'Destaques do Dia';
          newsListTitle.textContent = '√öltimas Not√≠cias';
        } else {
          const categoryNames = {
            urgentes: 'Urgentes',
            economia: 'Economia', 
            ciencia: 'Ci√™ncia',
            esportes: 'Esportes',
            cultura: 'Cultura',
            tecnologia: 'Tecnologia',
            saude: 'Sa√∫de'
          };
          
          const name = categoryNames[category] || category;
          sectionTitle.textContent = `Destaques de ${name}`;
          newsListTitle.textContent = `Not√≠cias de ${name}`;
        }
        
        // Recarregar conte√∫do
        loadInitialNews();
        
        if (category === 'all') {
          loadFeaturedNews();
        } else {
          loadCategoryFeatured(category);
        }
        
        loadTopNews();
        
        // Scroll para o topo
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      function loadCategoryFeatured(category) {
        if (!featuredContainer) return;
        
        const items = appState.currentNews.filter(n => n.category === category).slice(0, 3);
        featuredContainer.innerHTML = '';
        
        if (items.length === 0) {
          featuredContainer.innerHTML = '<p class="no-news">Nenhuma not√≠cia nesta categoria</p>';
          return;
        }
        
        items.forEach((news, index) => {
          const article = document.createElement('article');
          article.className = index === 0 ? 'main-featured' : 'secondary-featured';
          article.setAttribute('data-id', news.id);
          
          const commentsCount = getCommentsCount(news.id);
          const isMain = index === 0;
          
          article.innerHTML = `
            <div class="news-image">
              <img src="${news.image}" alt="${escapeHtml(news.title)}" loading="lazy">
              <span class="category-label ${news.category}">${news.categoryName}</span>
            </div>
            <div class="news-content">
              <h3 class="news-title">${escapeHtml(news.title)}</h3>
              ${isMain ? `<p class="news-excerpt">${news.excerpt}</p>` : ''}
              <div class="news-meta">
                <span><i class="far fa-clock"></i> ${news.time}</span>
                <span><i class="far fa-comment"></i> ${commentsCount} coment√°rios</span>
              </div>
            </div>
          `;
          
          article.addEventListener('click', () => openNewsModal(news.id));
          featuredContainer.appendChild(article);
        });
      }

      function searchNews() {
        const term = (searchInput.value || '').trim().toLowerCase();
        
        if (!term) {
          showNotification('Digite um termo para buscar');
          return;
        }
        
        appState.currentCategory = 'search';
        
        // Atualizar t√≠tulos
        document.getElementById('sectionTitle').textContent = `Resultados para: "${term}"`;
        document.getElementById('newsListTitle').textContent = 'Not√≠cias Encontradas';
        
        // Limpar container
        if (!newsContainer) return;
        newsContainer.innerHTML = '';
        
        // Filtrar not√≠cias
        const filtered = appState.currentNews.filter(n => 
          (n.title || '').toLowerCase().includes(term) || 
          (n.excerpt || '').toLowerCase().includes(term) ||
          (n.fullContent || '').toLowerCase().includes(term)
        );
        
        if (filtered.length === 0) {
          newsContainer.innerHTML = `
            <div class="no-results">
              <i class="fas fa-search"></i>
              <h3>Nenhuma not√≠cia encontrada</h3>
              <p>Tente outros termos de busca</p>
            </div>
          `;
          
          if (loadMoreBtn) loadMoreBtn.style.display = 'none';
          return;
        }
        
        // Mostrar resultados
        filtered.forEach(news => {
          newsContainer.appendChild(createNewsCard(news));
        });
        
        if (loadMoreBtn) loadMoreBtn.style.display = 'none';
        searchInput.value = '';
        
        // Scroll para resultados
        document.querySelector('.news-list').scrollIntoView({ behavior: 'smooth', block: 'start' });
        showNotification(`Encontradas ${filtered.length} not√≠cias`);
      }

      function openNewsModal(newsId) {
        const news = appState.currentNews.find(n => n.id === newsId);
        
        if (!news) {
          showNotification('Not√≠cia n√£o encontrada');
          return;
        }
        
        appState.currentNewsId = newsId;
        
        // Atualizar conte√∫do do modal
        const modalContent = document.getElementById('modalNewsContent');
        const commentsCount = getCommentsCount(newsId);
        
        modalContent.innerHTML = `
          <div class="news-full">
            <h2>${escapeHtml(news.title)}</h2>
            <div class="news-meta-full">
              <span><i class="far fa-clock"></i> ${news.time}</span>
              <span><i class="far fa-comment"></i> <span id="modalCommentCount">${commentsCount}</span> coment√°rios</span>
              <span class="category-label ${news.category}">${news.categoryName}</span>
            </div>
            <div class="news-full-image">
              <img src="${news.image}" alt="${escapeHtml(news.title)}">
            </div>
            <div class="news-body">${news.fullContent || ''}</div>
          </div>
        `;
        
        // Carregar coment√°rios
        loadComments(newsId);
        
        // Abrir modal
        openModal('newsModal');
      }

      // ==============================================
      // SISTEMA DE COMENT√ÅRIOS
      // ==============================================

      function getCommentsFor(newsId) {
        return appState.userComments[newsId] ? [...appState.userComments[newsId]] : [];
      }

      function getCommentsCount(newsId) {
        return getCommentsFor(newsId).length;
      }

      function loadComments(newsId) {
        const commentsList = document.getElementById('commentsList');
        const commentCount = document.getElementById('commentCount');
        const modalCommentCount = document.getElementById('modalCommentCount');
        
        const comments = getCommentsFor(newsId);
        
        // Ordenar por data (mais recentes primeiro)
        comments.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
        
        // Atualizar contadores
        if (commentCount) commentCount.textContent = `(${comments.length})`;
        if (modalCommentCount) modalCommentCount.textContent = comments.length;
        
        if (!commentsList) return;
        
        if (comments.length === 0) {
          commentsList.innerHTML = '<p class="no-comments">Seja o primeiro a comentar esta not√≠cia!</p>';
          return;
        }
        
        // Renderizar coment√°rios
        commentsList.innerHTML = comments.map(comment => renderCommentHtml(newsId, comment)).join('');
        
        // Atualizar bot√µes de curtida
        updateLikeButtons();
      }

      function renderCommentHtml(newsId, comment) {
        const isLiked = appState.likedByUser.includes(String(comment.id));
        const likedClass = isLiked ? 'liked' : '';
        
        return `
          <div class="comment" data-comment-id="${comment.id}">
            <div class="comment-header">
              <div class="comment-author"><i class="fas fa-user"></i> ${escapeHtml(comment.author)}</div>
              <div class="comment-date">${escapeHtml(comment.date)}</div>
            </div>
            <div class="comment-text">${escapeHtml(comment.text)}</div>
            <div class="comment-actions-comment">
              <button class="like-btn ${likedClass}" data-news-id="${newsId}" data-comment-id="${comment.id}">
                <i class="far fa-thumbs-up"></i> Curtir (<span class="like-count">${comment.likes || 0}</span>)
              </button>
            </div>
          </div>
        `;
      }

      function toggleLike(newsId, commentId) {
        const commentIdStr = String(commentId);
        
        // Verificar se j√° curtiu
        if (appState.likedByUser.includes(commentIdStr)) {
          showNotification('Voc√™ j√° curtiu este coment√°rio');
          return;
        }
        
        // Encontrar coment√°rio
        if (!appState.userComments[newsId]) appState.userComments[newsId] = [];
        const comment = appState.userComments[newsId].find(c => c.id === commentId);
        
        if (!comment) {
          showNotification('Coment√°rio n√£o encontrado');
          return;
        }
        
        // Incrementar curtidas
        comment.likes = (comment.likes || 0) + 1;
        appState.likedByUser.push(commentIdStr);
        
        // Salvar no localStorage
        localStorage.setItem(STORAGE_LIKED_KEY, JSON.stringify(appState.likedByUser));
        localStorage.setItem(STORAGE_COMMENTS_KEY, JSON.stringify(appState.userComments));
        
        // Recarregar coment√°rios
        loadComments(newsId);
        showNotification('Curtida registrada!');
      }

      function updateLikeButtons() {
        document.querySelectorAll('.like-btn').forEach(btn => {
          const commentId = btn.dataset.commentId;
          if (appState.likedByUser.includes(String(commentId))) {
            btn.classList.add('liked');
          } else {
            btn.classList.remove('liked');
          }
        });
      }

      function submitCommentHandler() {
        const textarea = document.getElementById('commentText');
        if (!textarea) return;
        
        const text = textarea.value.trim();
        
        if (!text) {
          showNotification('Digite um coment√°rio antes de enviar');
          return;
        }
        
        if (text.length > 500) {
          showNotification('M√°ximo de 500 caracteres');
          return;
        }
        
        const newsId = appState.currentNewsId;
        
        if (!newsId) {
          showNotification('Abra uma not√≠cia antes de comentar');
          return;
        }
        
        // Criar coment√°rio
        if (!appState.userComments[newsId]) appState.userComments[newsId] = [];
        
        const newComment = {
          id: Date.now(),
          author: appState.userName,
          text: text,
          date: 'Agora mesmo',
          timestamp: Date.now(),
          likes: 0
        };
        
        appState.userComments[newsId].push(newComment);
        localStorage.setItem(STORAGE_COMMENTS_KEY, JSON.stringify(appState.userComments));
        
        // Limpar textarea
        textarea.value = '';
        document.getElementById('charCount').textContent = '0/500';
        
        // Recarregar coment√°rios
        loadComments(newsId);
        
        // Atualizar contadores em outras partes
        loadFeaturedNews();
        loadInitialNews();
        loadTopNews();
        
        showNotification('Coment√°rio enviado com sucesso!');
      }

      // ==============================================
      // NEWSLETTER / ASSINATURA
      // ==============================================

      async function subscribeToEndpoint(email) {
        const payload = {
          email: email,
          timestamp: new Date().toISOString(),
          source: window.location.href,
          message: `Novo assinante JupterNews: ${email}`
        };
        
        try {
          const response = await fetch(FORM_ENDPOINT, {
            method: 'POST',
            headers: {
              'Accept': 'application/json',
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(payload)
          });
          
          return { ok: response.ok };
        } catch (error) {
          return { ok: false, error: error.message };
        }
      }

      async function subscribeModalHandler() {
        const emailInput = document.getElementById('subscribeEmail');
        const email = (emailInput.value || '').trim();
        
        if (!validateEmail(email)) {
          showNotification('Por favor, insira um e-mail v√°lido');
          return;
        }
        
        // Salvar localmente
        if (!appState.subscribers.includes(email)) {
          appState.subscribers.push(email);
          localStorage.setItem(STORAGE_SUBSCRIBERS_KEY, JSON.stringify(appState.subscribers));
        }
        
        // Desabilitar bot√£o enquanto envia
        confirmSubscribeBtn.disabled = true;
        confirmSubscribeBtn.textContent = 'Enviando...';
        
        // Enviar para Formspree
        const result = await subscribeToEndpoint(email);
        
        // Re-habilitar bot√£o
        confirmSubscribeBtn.disabled = false;
        confirmSubscribeBtn.textContent = 'Confirmar Assinatura';
        
        if (result.ok) {
          showNotification('Assinatura confirmada! Voc√™ receber√° nossas not√≠cias em breve.');
          closeModal('subscribeModal');
        } else {
          showNotification('Assinatura salva localmente. Houve um problema ao enviar.');
        }
        
        emailInput.value = '';
      }

      async function footerSubscribeHandler() {
        const emailInput = document.getElementById('newsletterEmail');
        const email = (emailInput.value || '').trim();
        
        if (!validateEmail(email)) {
          showNotification('Por favor, insira um e-mail v√°lido');
          return;
        }
        
        if (!appState.subscribers.includes(email)) {
          appState.subscribers.push(email);
          localStorage.setItem(STORAGE_SUBSCRIBERS_KEY, JSON.stringify(appState.subscribers));
        }
        
        // Feedback visual
        footerSubscribeBtn.disabled = true;
        const originalHTML = footerSubscribeBtn.innerHTML;
        footerSubscribeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
        
        // Enviar para Formspree
        const result = await subscribeToEndpoint(email);
        
        // Restaurar bot√£o
        footerSubscribeBtn.disabled = false;
        footerSubscribeBtn.innerHTML = originalHTML;
        
        if (result.ok) {
          showNotification('Assinatura confirmada! Obrigado por se inscrever.');
        } else {
          showNotification('Assinatura salva localmente. Houve um problema ao enviar.');
        }
        
        emailInput.value = '';
      }

      // ==============================================
      // NOT√çCIAS MAIS LIDAS
      // ==============================================

      function loadTopNews() {
        const topList = document.getElementById('topNewsList');
        if (!topList) return;
        
        const topNews = [...appState.currentNews]
          .sort((a, b) => getCommentsCount(b.id) - getCommentsCount(a.id))
          .slice(0, 5);
        
        topList.innerHTML = '';
        
        if (topNews.length === 0) {
          topList.innerHTML = '<li>Nenhuma not√≠cia com coment√°rios</li>';
          return;
        }
        
        topNews.forEach(news => {
          const li = document.createElement('li');
          li.textContent = news.title.length > 60 ? news.title.substring(0, 60) + '...' : news.title;
          li.title = news.title;
          li.addEventListener('click', () => openNewsModal(news.id));
          topList.appendChild(li);
        });
      }

      // ==============================================
      // FUN√á√ïES AUXILIARES
      // ==============================================

      function getCurrentNews() {
        if (appState.currentCategory === 'all' || appState.currentCategory === 'search') {
          return appState.currentNews;
        }
        return appState.currentNews.filter(n => n.category === appState.currentCategory);
      }

      function updateLoadMoreButton() {
        const currentNews = getCurrentNews();
        const hasMore = appState.displayedNews < currentNews.length;
        const btn = document.getElementById('loadMoreBtn');
        
        if (!btn) return;
        
        btn.style.display = hasMore ? 'block' : 'none';
        btn.disabled = !hasMore;
        btn.innerHTML = hasMore 
          ? '<i class="fas fa-plus"></i> Carregar Mais Not√≠cias' 
          : '<i class="fas fa-check"></i> Todas as not√≠cias carregadas';
      }

      function openModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
          modal.style.display = 'block';
          document.body.classList.add('modal-open');
          document.body.style.overflow = 'hidden';
        }
      }

      function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modal) {
          modal.style.display = 'none';
          document.body.classList.remove('modal-open');
          document.body.style.overflow = '';
        }
      }

      function closeAllModals() {
        document.querySelectorAll('.modal').forEach(modal => {
          modal.style.display = 'none';
        });
        document.body.classList.remove('modal-open');
        document.body.style.overflow = '';
      }

      function validateEmail(email) {
        const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return re.test(email);
      }

      function showNotification(message) {
        // Remover notifica√ß√µes anteriores
        const existing = document.querySelectorAll('.notification');
        existing.forEach(n => n.remove());
        
        // Criar nova notifica√ß√£o
        const notification = document.createElement('div');
        notification.className = 'notification';
        notification.innerHTML = `
          <i class="fas fa-check-circle"></i>
          <span>${escapeHtml(message)}</span>
        `;
        
        document.body.appendChild(notification);
        
        // Animar entrada
        setTimeout(() => {
          notification.style.opacity = '1';
          notification.style.transform = 'translateY(-6px)';
        }, 10);
        
        // Auto-remover ap√≥s 3 segundos
        setTimeout(() => {
          notification.style.opacity = '0';
          notification.style.transform = 'translateY(0)';
          setTimeout(() => notification.remove(), 300);
        }, 3000);
      }

      function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      // ==============================================
      // FUN√á√ïES GLOBAIS (para footer)
      // ==============================================
      
      window.filterNews = function(category) {
        const link = document.querySelector(`.nav-link[data-category="${category}"]`);
        if (link) {
          link.click();
        } else {
          // Fallback se o link n√£o for encontrado
          filterByCategory(category);
        }
      };

      window.showAbout = function() {
        alert('JupterNews √© um portal de not√≠cias dedicado a trazer informa√ß√µes atualizadas e confi√°veis 24 horas por dia.');
      };
      
      window.showContact = function() {
        alert('Contato: contato@jupternews.com\nTelefone: (11) 99999-9999');
      };
      
      window.showPrivacy = function() {
        alert('Nossa pol√≠tica de privacidade garante que seus dados est√£o seguros e s√£o usados apenas para melhorar sua experi√™ncia.');
      };
      
      window.showTerms = function() {
        alert('Termos de uso: Voc√™ concorda em usar este site apenas para fins legais e respeitar os direitos autorais.');
      };
      
      window.showCareers = function() {
        alert('Envie seu curr√≠culo para: carreiras@jupternews.com');
      };
      
      window.playVideo = function(title) {
        const modal = document.getElementById('videoModal');
        const player = document.getElementById('videoPlayer');
        
        player.innerHTML = `
          <div class="video-placeholder">
            <i class="fas fa-play-circle"></i>
            <h3>${escapeHtml(title)}</h3>
            <p>Esta √© uma demonstra√ß√£o do player de v√≠deo.</p>
            <p>Em um ambiente real, aqui estaria o v√≠deo embedado do YouTube ou Vimeo.</p>
          </div>
        `;
        
        openModal('videoModal');
      };

      // ==============================================
      // REGISTRAR SERVICE WORKER (PWA)
      // ==============================================
      
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(registration => {
              console.log('ServiceWorker registrado com sucesso: ', registration.scope);
            })
            .catch(error => {
              console.log('Falha ao registrar ServiceWorker: ', error);
            });
        });
      }
    });
  </script>
</body>
</html>